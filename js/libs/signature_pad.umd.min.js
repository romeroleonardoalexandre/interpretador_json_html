/*!
 * Signature Pad v3.0.0-beta.3 | https://github.com/szimek/signature_pad
 * (c) 2018 Szymon Nowak | Released under the MIT license
 */!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.SignaturePad=b()}(this,function(){"use strict";var b=Math.sqrt,f=function(){function a(a,b,c){this.x=a,this.y=b,this.time=c||Date.now()}return a.prototype.distanceTo=function(a){var c=Math.pow;return b(c(this.x-a.x,2)+c(this.y-a.y,2))},a.prototype.equals=function(a){return this.x===a.x&&this.y===a.y&&this.time===a.time},a.prototype.velocityFrom=function(a){return this.time===a.time?0:this.distanceTo(a)/(this.time-a.time)},a}(),a=function(){function a(a,b,c,d,e,f){this.startPoint=a,this.control2=b,this.control1=c,this.endPoint=d,this.startWidth=e,this.endWidth=f}return a.fromPoints=function(b,c){var d=this.calculateControlPoints(b[0],b[1],b[2]).c2,e=this.calculateControlPoints(b[1],b[2],b[3]).c1;return new a(b[1],d,e,b[2],c.start,c.end)},a.calculateControlPoints=function(g,e,j){var k=g.x-e.x,i=g.y-e.y,n=e.x-j.x,o=e.y-j.y,h=(g.x+e.x)/2,a=(g.y+e.y)/2,c=(e.x+j.x)/2,q=(e.y+j.y)/2,d=b(k*k+i*i),l=b(n*n+o*o),r=l/(d+l),p=e.x-(c+(h-c)*r),m=e.y-(q+(a-q)*r);return{c1:new f(h+p,a+m),c2:new f(c+p,q+m)}},a.prototype.length=function(){for(var c,d,f=0,g=0;10>=g;g+=1){var j=g/10,i=this.point(j,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),k=this.point(j,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(0<g){var l=i-c,h=k-d;f+=b(l*l+h*h)}c=i,d=k}return f},a.prototype.point=function(a,b,c,d,e){return b*(1-a)*(1-a)*(1-a)+3*c*(1-a)*(1-a)*a+3*d*(1-a)*a*a+e*a*a*a},a}();return function(){var d=Math.max;function b(a,c){void 0===c&&(c={});var d=this;this.canvas=a,this.options=c,this._handleMouseDown=function(a){1===a.which&&(d._mouseButtonDown=!0,d._strokeBegin(a))},this._handleMouseMove=function(a){d._mouseButtonDown&&d._strokeMoveUpdate(a)},this._handleMouseUp=function(a){1===a.which&&d._mouseButtonDown&&(d._mouseButtonDown=!1,d._strokeEnd(a))},this._handleTouchStart=function(a){if(a.preventDefault(),1===a.targetTouches.length){var b=a.changedTouches[0];d._strokeBegin(b)}},this._handleTouchMove=function(a){a.preventDefault();var b=a.targetTouches[0];d._strokeMoveUpdate(b)},this._handleTouchEnd=function(a){if(a.target===d.canvas){a.preventDefault();var b=a.changedTouches[0];d._strokeEnd(b)}},this.velocityFilterWeight=c.velocityFilterWeight||.7,this.minWidth=c.minWidth||.5,this.maxWidth=c.maxWidth||2.5,this.throttle="throttle"in c?c.throttle:16,this.minDistance="minDistance"in c?c.minDistance:5,this._strokeMoveUpdate=this.throttle?function(b,f){void 0===f&&(f=250);var g,j,k,l=0,m=null,p=function(){l=Date.now(),m=null,g=b.apply(j,k),m||(j=null,k=[])};return function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];var h=Date.now(),i=f-(h-l);return j=this,k=e,0>=i||i>f?(m&&(clearTimeout(m),m=null),l=h,g=b.apply(j,k),m||(j=null,k=[])):m||(m=window.setTimeout(p,i)),g}}(b.prototype._strokeUpdate,this.throttle):b.prototype._strokeUpdate,this.dotSize=c.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=c.penColor||"black",this.backgroundColor=c.backgroundColor||"rgba(0,0,0,0)",this.onBegin=c.onBegin,this.onEnd=c.onEnd,this._ctx=a.getContext("2d"),this.clear(),this.on()}return b.prototype.clear=function(){var a=this._ctx,b=this.canvas;a.fillStyle=this.backgroundColor,a.clearRect(0,0,b.width,b.height),a.fillRect(0,0,b.width,b.height),this._data=[],this._reset(),this._isEmpty=!0},b.prototype.fromDataURL=function(a,b,c){var d=this;void 0===b&&(b={});var f=new Image,g=b.ratio||window.devicePixelRatio||1,i=b.width||this.canvas.width/g,j=b.height||this.canvas.height/g;this._reset(),f.onload=function(){d._ctx.drawImage(f,0,0,i,j),c&&c()},f.onerror=function(a){c&&c(a)},f.src=a,this._isEmpty=!1},b.prototype.toDataURL=function(a,b){switch(void 0===a&&(a="image/png"),a){case"image/svg+xml":return this._toSVG();default:return this.canvas.toDataURL(a,b);}},b.prototype.on=function(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",window.PointerEvent?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())},b.prototype.off=function(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.removeEventListener("pointerdown",this._handleMouseDown),this.canvas.removeEventListener("pointermove",this._handleMouseMove),document.removeEventListener("pointerup",this._handleMouseUp),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)},b.prototype.isEmpty=function(){return this._isEmpty},b.prototype.fromData=function(a){var b=this;this.clear(),this._fromData(a,function(a){var c=a.color,d=a.curve;return b._drawCurve({color:c,curve:d})},function(a){var c=a.color,d=a.point;return b._drawDot({color:c,point:d})}),this._data=a},b.prototype.toData=function(){return this._data},b.prototype._strokeBegin=function(a){var b={color:this.penColor,points:[]};"function"==typeof this.onBegin&&this.onBegin(a),this._data.push(b),this._reset(),this._strokeUpdate(a)},b.prototype._strokeUpdate=function(b){var d=b.clientX,e=b.clientY,f=this._createPoint(d,e),g=this._data[this._data.length-1],i=g.points,j=0<i.length&&i[i.length-1],k=!!j&&f.distanceTo(j)<=this.minDistance,h=g.color;if(!j||!j||!k){var a=this._addPoint(f);j?a&&this._drawCurve({color:h,curve:a}):this._drawDot({color:h,point:f}),i.push({time:f.time,x:f.x,y:f.y})}},b.prototype._strokeEnd=function(a){this._strokeUpdate(a),"function"==typeof this.onEnd&&this.onEnd(a)},b.prototype._handlePointerEvents=function(){this._mouseButtonDown=!1,this.canvas.addEventListener("pointerdown",this._handleMouseDown),this.canvas.addEventListener("pointermove",this._handleMouseMove),document.addEventListener("pointerup",this._handleMouseUp)},b.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},b.prototype._handleTouchEvents=function(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)},b.prototype._reset=function(){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},b.prototype._createPoint=function(a,b){var c=this.canvas.getBoundingClientRect();return new f(a-c.left,b-c.top,new Date().getTime())},b.prototype._addPoint=function(b){var c=this._lastPoints;if(c.push(b),2<c.length){3===c.length&&c.unshift(c[0]);var d=this._calculateCurveWidths(c[1],c[2]),e=a.fromPoints(c,d);return c.shift(),e}return null},b.prototype._calculateCurveWidths=function(a,b){var c=this.velocityFilterWeight*b.velocityFrom(a)+(1-this.velocityFilterWeight)*this._lastVelocity,d=this._strokeWidth(c),e={end:d,start:this._lastWidth};return this._lastVelocity=c,this._lastWidth=d,e},b.prototype._strokeWidth=function(a){return d(this.maxWidth/(a+1),this.minWidth)},b.prototype._drawCurveSegment=function(a,b,c){var d=this._ctx;d.moveTo(a,b),d.arc(a,b,c,0,2*Math.PI,!1),this._isEmpty=!1},b.prototype._drawCurve=function(b){var g=b.color,e=b.curve,j=this._ctx,k=e.endWidth-e.startWidth,i=2*Math.floor(e.length());j.beginPath(),j.fillStyle=g;for(var m=0;m<i;m+=1){var n=m/i,h=n*n,a=h*n,c=1-n,o=c*c,d=o*c,l=d*e.startPoint.x;l+=3*o*n*e.control1.x,l+=3*c*h*e.control2.x,l+=a*e.endPoint.x;var q=d*e.startPoint.y;q+=3*o*n*e.control1.y,q+=3*c*h*e.control2.y,q+=a*e.endPoint.y;var s=e.startWidth+a*k;this._drawCurveSegment(l,q,s)}j.closePath(),j.fill()},b.prototype._drawDot=function(a){var b=a.color,c=a.point,d=this._ctx,e="function"==typeof this.dotSize?this.dotSize():this.dotSize;d.beginPath(),this._drawCurveSegment(c.x,c.y,e),d.closePath(),d.fillStyle=b,d.fill()},b.prototype._fromData=function(b,e,g){for(var j=0,k=b;j<k.length;j++){var m=k[j],n=m.color,h=m.points;if(1<h.length)for(var a=0;a<h.length;a+=1){var o=h[a],p=new f(o.x,o.y,o.time);this.penColor=n,0==a&&this._reset();var d=this._addPoint(p);d&&e({color:n,curve:d})}else this._reset(),g({color:n,point:h[0]})}},b.prototype._toSVG=function(){var b=this,f=this._data,e=d(window.devicePixelRatio||1,1),g=this.canvas.width/e,j=this.canvas.height/e,k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttribute("width",this.canvas.width.toString()),k.setAttribute("height",this.canvas.height.toString()),this._fromData(f,function(a){var b=a.color,c=a.curve,d=document.createElement("path");if(!(isNaN(c.control1.x)||isNaN(c.control1.y)||isNaN(c.control2.x)||isNaN(c.control2.y))){var e="M "+c.startPoint.x.toFixed(3)+","+c.startPoint.y.toFixed(3)+" C "+c.control1.x.toFixed(3)+","+c.control1.y.toFixed(3)+" "+c.control2.x.toFixed(3)+","+c.control2.y.toFixed(3)+" "+c.endPoint.x.toFixed(3)+","+c.endPoint.y.toFixed(3);d.setAttribute("d",e),d.setAttribute("stroke-width",(2.25*c.endWidth).toFixed(3)),d.setAttribute("stroke",b),d.setAttribute("fill","none"),d.setAttribute("stroke-linecap","round"),k.appendChild(d)}},function(a){var c=a.color,d=a.point,e=document.createElement("circle"),f="function"==typeof b.dotSize?b.dotSize():b.dotSize;e.setAttribute("r",f.toString()),e.setAttribute("cx",d.x.toString()),e.setAttribute("cy",d.y.toString()),e.setAttribute("fill",c),k.appendChild(e)});var i=k.innerHTML;if(void 0===i){var l=document.createElement("dummy"),a=k.childNodes;l.innerHTML="";for(var c=0;c<a.length;c+=1)l.appendChild(a[c].cloneNode(!0));i=l.innerHTML}return"data:image/svg+xml;base64,"+btoa("<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 "+g+" "+j+"\" width=\""+g+"\" height=\""+j+"\">"+i+"</svg>")},b}()});